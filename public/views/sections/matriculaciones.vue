<script>module.exports={data:function data(){return{filter:"",id_anos_lectivosss:"",id_jornadasss:"",id_cursosss:"",id_paralelos_aulasss:"",formBusqueda:!1,y:"",formActualizar:!1,ids:-1,id_paralelos_aulass:" ",id_cursoss:"",id_anos_lectivoss:"",options:{paralelos_aulas:[],cpa:[],anos_lectivosss:[],jornadasss:[],cursosss:[],paralelos_aulasss:[]},matriculaciones:{loading:!1,data:[],columns:[{name:"id",field:"id",label:"N\xBA Matricula"},{name:"numero_documento",field:"numero_documento",label:"N\xFAmero Documento"},{name:"nombre_completo",field:"nombre_completo",label:"Estudiante"},{name:"curso",field:"curso",label:"Curso"},{name:"jornada",field:"jornada",label:"Jornada"},{name:"paralelo_aula",field:"paralelo_aula",label:"Paralelo - Aula"},{name:"ano_lectivo",field:"ano_lectivo",label:"A\xF1o Lectivo"}]},matru:{loading:!1,data:[],pres:[{name:"numero_documento",field:"numero_documento",label:"N\xFAmero Documento"},{name:"nombre_completo",field:"nombre_completo",label:"Nombres"}]}}},filters:{capitalize:function capitalize(a){return a?(a=a.toString(),a.charAt(0).toUpperCase()+a.slice(1)):""},upper:function upper(a){return a?(a=a.toString(),a.toUpperCase()):""}},created:function created(){this.anos_lectivosss(),this.listaMatriculaciones(),this.init()},methods:{anos_lectivosss:function anos_lectivosss(){var a=this;return _.rget("anos_lectivos/ctlg").then(function(b){a.options.anos_lectivosss=b.data})},jornadasss:function jornadasss(){var a=this;return _.rget("jornadas/ctlg/".concat(this.id_anos_lectivosss)).then(function(b){a.options.jornadasss=b.data})},cursosss:function cursosss(){var a=this;return _.rget("catalogos/cursos_jornadas/".concat(this.id_jornadasss)).then(function(b){a.options.cursosss=b.data})},paralelos_aulasss:function paralelos_aulasss(){var a=this;return _.rget("docentes_asignar_cursos/cur_paralelos_aulas/".concat(this.id_cursosss)).then(function(b){a.options.paralelos_aulasss=b.data})},cpa:function cpa(){var a=this;return _.rget("matriculaciones/ctlg_catal/".concat(this.id_paralelos_aulasss)).then(function(b){a.options.cpa=b.data[0].label,a.y=a.options.cpa})},editarMatricula:function editarMatricula(a){this.id_anos_lectivoss=a.ano_lectivo,this.id_cursoss=a.curso,this.paralelos_aulas(),this.ids=a.id,this.id_paralelos_aulass=a.paralelo_aula,this.formActualizar=!0},paralelos_aulas:function paralelos_aulas(){var a=this;return _.rget("matriculaciones/matri_paralelos_aulas",{anoss:this.id_anos_lectivoss,cursoss:this.id_cursoss}).then(function(b){a.options.paralelos_aulas=b.data})},nuevo:function nuevo(){this.formBusqueda=!0},excel:function excel(){var a=this;return this.$q.loading.show(),_.rpost("matriculaciones/docu",{id_anos_lectivosss:this.id_anos_lectivosss,id_jornadasss:this.id_jornadasss,id_cursosss:this.id_cursosss,id_paralelos_aulasss:this.id_paralelos_aulasss}).then(function(b){a.matru.data=b.data,a.formBusqueda=!1,a.report("Lista de Estudiantes "+a.y,a.matru.pres,a.matru.data)}).then(function(){a.id_anos_lectivosss="",a.id_jornadasss="",a.id_cursosss="",a.id_paralelos_aulasss=""})["catch"](function(b){a.$q.notify({type:"negative",message:b.message||"Hubo un error al guardar"})})["finally"](function(){a.$q.loading.hide()})},guardar:function guardar(a){var b=this;null!==this.id_paralelos_aulass&&""!==this.id_paralelos_aulass?_.rput("matriculaciones/".concat(this.ids),null,{ids:a.id,id_paralelos_aulass:this.id_paralelos_aulass}).then(function(){b.formActualizar=!1,b.listaMatriculaciones(),b.$q.notify({type:"positive",message:"Actualizado con exito",timeout:500})})["catch"](function(a){b.$q.notify({type:"negative",message:a.message||"Hubo un error al actualizar"})})["finally"](function(){b.$q.loading.hide()}):this.$q.notify({type:"negative",message:"No se puede actualizar"})},eliminar:function eliminar(a){var b=this;this.ids=a.id,this.$q.loading.show(),_.rdelete("matriculaciones/elim/".concat(this.ids),null,{ids:a.id}).then(function(){b.listaMatriculaciones(),b.$q.notify({type:"positive",message:"Eliminado con exito",timeout:500})})["catch"](function(a){b.$q.notify({type:"negative",message:a.message||"Hubo un error al eliminar"})})["finally"](function(){b.$q.loading.hide()})},nuevoMatricula:function nuevoMatricula(){this.modal("matricula",{})},listaMatriculaciones:function listaMatriculaciones(){var a=this;this.matriculaciones.loading=!0,_.rget("matriculaciones").then(function(b){a.matriculaciones.data=b.data})["finally"](function(){a.matriculaciones.loading=!1})}}};</script> <style></style> <template> <q-page class="q-pa-md"> <br /> <q-table class="q-pa-md" title="Matriculaciones" :data="matriculaciones.data" :columns="matriculaciones.columns" row-key="id" :filter="filter" :loading="matriculaciones.loading" > <template v-slot:top-right> <div class="q-gutter-md row"> <q-btn color="primary" icon-right="add" label="Nueva Matricula" no-caps @click="nuevoMatricula" ></q-btn> <q-btn color="teal" icon="save_alt" @click="nuevo"> <q-tooltip> Exportar a Excel </q-tooltip> </q-btn> <q-dialog v-model="formBusqueda" persistent transition-show="scale" transition-hide="scale" > <q-card style="width: 300px"> <q-card-section> <div class="text-h6"> Lista de Estudiantes-Curso </div> </q-card-section> <q-card-section style="max-height: 50vh" class="scroll" > <q-form class="q-gutter-md"> <q-select v-model="id_anos_lectivosss" @input="jornadasss()" :options="options.anos_lectivosss" label="Año Lectivo" emit-value map-options ></q-select> <q-select v-model="id_jornadasss" @input="cursosss()" :options="options.jornadasss" label="Jornadas" emit-value map-options ></q-select> <q-select v-model="id_cursosss" @input="paralelos_aulasss()" :options="options.cursosss" label="Cursos" emit-value map-options ></q-select> <q-select v-model="id_paralelos_aulasss" :options="options.paralelos_aulasss" @input="cpa()" label="Paralelos - Aulas" emit-value map-options ></q-select> </q-form> </q-card-section> <q-card-actions align="right"> <q-btn color="primary" @click="excel" >Exportar</q-btn > <q-btn flat v-close-popup>cancelar</q-btn> </q-card-actions> </q-card> </q-dialog> <q-input filled borderless dense debounce="300" v-model="filter" placeholder="Buscar" > <template v-slot:append> <q-icon name="search" /> </template> </q-input> </div> </template> <template v-slot:header="props"> <q-tr text-align: center bgcolor="orange" :props="props"> <q-th auto-width style="text-align: center" v-for="col in props.cols" :key="col.name" :props="props" > {{ col.label }} </q-th> <q-th auto-width>Acción</q-th> </q-tr> </template> <template v-slot:body="props"> <q-tr :props="props"> <q-td style="text-align: center" v-for="col in props.cols" :key="col.name" :props="props" > {{ col.value | upper }} </q-td> <q-td auto-width style="text-align: center"> <span v-if="formActualizar && ids == props.row.id"> <q-btn color="primary" round dense icon="check_circle" @click="guardar" > </q-btn> <q-btn color="negative" round dense icon="close" @click="formActualizar = false" ></q-btn> </span> <span v-else> <q-btn color="primary" round dense icon="edit" @click="editarMatricula(props.row)" ></q-btn> <q-btn color="negative" round dense icon="delete" @click=" eliminar(props.row) && ida == props.row.idaj " ></q-btn> </span> </q-td> </q-tr> <q-tr v-show="formActualizar && ids == props.row.id" :props="props" > <q-td colspan="100%"> <q-select v-model="id_paralelos_aulass" :options="options.paralelos_aulas" label="Paralelo - Aula" emit-value map-options ></q-select> </q-td> </q-tr> </template> <template v-slot:loading> <q-inner-loading showing color="primary"></q-inner-loading> </template> </q-table> </q-page></template>