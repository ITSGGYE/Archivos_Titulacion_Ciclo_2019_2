<script>module.exports={data:function data(){return{filter:"",formActualizar:!1,ids:-1,nombress:"",apellidoss:"",id_ctlg_tipos_documentoss:"",numero_documentoss:"",id_ctlg_profesioness:"",correoss:"",direccionss:"",telefonoss:"",options:{profesiones:[],tipos_documentos:[]},docentes:{loading:!1,columns:[{name:"numero_documento",field:"numero_documento",label:"N\xFAmero Documento"},{name:"nombre_completo",field:"nombre_completo",label:"Nombres"},{name:"correo",field:"correo",label:"Correo"},{name:"telefono",field:"telefono",label:"Celular"},{name:"direccion",field:"direccion",label:"Direcci\xF3n"},{name:"profesion",field:"profesion",label:"Profesi\xF3n"},{name:"genero",field:"genero",label:"G\xE9nero"}],data:[]}}},filters:{capitalize:function capitalize(a){return a?(a=a.toString(),a.charAt(0).toUpperCase()+a.slice(1)):""},upper:function upper(a){return a?(a=a.toString(),a.toUpperCase()):""}},created:function created(){var a=this;this.listaDocentes(),Promise.all([this.profesiones(),this.tipos_documentos()]).then(function(){a.init()})},methods:{excel:function excel(){this.report("Reporte Docentes ",this.docentes.columns,this.docentes.data)},profesiones:function profesiones(){var a=this;return _.rget("catalogos/profesiones").then(function(b){a.options.profesiones=b.data})},tipos_documentos:function tipos_documentos(){var a=this;return _.rget("catalogos/tipos_documentos").then(function(b){a.options.tipos_documentos=b.data})},validEmail:function validEmail(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},editarDocente:function editarDocente(a){this.ids=a.id,this.nombress=a.nombres,this.apellidoss=a.apellidos,this.id_ctlg_tipos_documentoss=a.id_ctlg_tipos_documentos,this.numero_documentoss=a.numero_documento,this.id_ctlg_profesioness=a.id_ctlg_profesiones,this.correoss=a.correo,this.direccionss=a.direccion,this.telefonoss=a.telefono,this.formActualizar=!0},guardar:function guardar(a){var b=this;if(!this.validEmail(this.correoss))this.$q.notify({type:"negative",message:"correo invalido"});else if(1==this.id_ctlg_tipos_documentoss){var c=this.numero_documentoss;if(10==c.length){var d=c.substring(0,2);if(1<=d&&24>=d){var e=c.substring(9,10),f=parseInt(c.substring(1,2))+parseInt(c.substring(3,4))+parseInt(c.substring(5,6))+parseInt(c.substring(7,8)),g=c.substring(0,1),g=2*g;if(9<g)var g=g-9;var h=c.substring(2,3),h=2*h;if(9<h)var h=h-9;var i=c.substring(4,5),i=2*i;if(9<i)var i=i-9;var j=c.substring(6,7),j=2*j;if(9<j)var j=j-9;var k=c.substring(8,9),k=2*k;if(9<k)var k=k-9;var l=g+h+i+j+k,m=f+l,n=(m+"").substring(0,1),o=10*(parseInt(n)+1),p=o-m;if(10==p)var p=0;p==e?(this.$q.loading.show(),_.rput("docentes/".concat(this.ids),null,{ids:a.id,nombress:this.nombress,apellidoss:this.apellidoss,numero_documentoss:this.numero_documentoss,id_ctlg_profesioness:this.id_ctlg_profesioness,correoss:this.correoss,direccionss:this.direccionss,telefonoss:this.telefonoss}).then(function(){b.formActualizar=!1,b.listaDocentes(),b.$q.notify({type:"positive",message:"Actualizado con exito"})})["catch"](function(a){b.$q.notify({type:"negative",message:a.message||"Hubo un error al actualizar"})})["finally"](function(){b.$q.loading.hide()})):this.$q.notify({type:"negative",message:"la cedula es incorrecta"})}else this.$q.notify({type:"negative",message:"Esta cedula no pertenece a ninguna region"})}else this.$q.notify({type:"negative",message:"Esta cedula tiene menos de 10 Digitos"})}else this.$q.loading.show(),_.rput("docentes/".concat(this.ids),null,{ids:a.id,nombress:this.nombress,apellidoss:this.apellidoss,numero_documentoss:this.numero_documentoss,id_ctlg_profesioness:this.id_ctlg_profesioness,correoss:this.correoss,direccionss:this.direccionss,telefonoss:this.telefonoss}).then(function(){b.formActualizar=!1,b.listaDocentes(),b.$q.notify({type:"positive",message:"Actualizado con exito",timeout:500})})["catch"](function(a){b.$q.notify({type:"negative",message:a.message||"Hubo un error al actualizar"})})["finally"](function(){b.$q.loading.hide()})},eliminar:function eliminar(a){var b=this;this.ids=a.id,this.$q.loading.show(),_.rdelete("docentes/elim/".concat(this.ids),null,{ids:a.id}).then(function(){b.listaDocentes(),b.$q.notify({type:"positive",message:"Eliminado con exito",timeout:500})})["catch"](function(a){b.$q.notify({type:"negative",message:a.message||"Hubo un error al eliminar"})})["finally"](function(){b.$q.loading.hide()})},nuevoDocente:function nuevoDocente(){this.modal("docente",{})},listaDocentes:function listaDocentes(){var a=this;this.docentes.loading=!0,_.rget("docentes").then(function(b){a.docentes.data=b.data})["finally"](function(){a.docentes.loading=!1})}}};</script> <style></style> <template> <q-page class="q-pa-md"> <br /> <q-table class="q-pa-md" title="Docentes" :data="docentes.data" :columns="docentes.columns" row-key="id" :filter="filter" :loading="docentes.loading" > <template v-slot:top-right> <div class="q-gutter-md row"> <q-btn color="primary" icon-right="add" label="Nuevo Docente" no-caps @click="nuevoDocente" ></q-btn> <q-btn color="teal" icon="save_alt" @click="excel"> <q-tooltip> Exportar a Excel </q-tooltip> </q-btn> <q-input filled borderless dense debounce="300" v-model="filter" placeholder="Search" > <template v-slot:append> <q-icon name="search" /> </template> </q-input> </div> </template> <template v-slot:header="props"> <br /> <q-tr text-align: center bgcolor="orange" :props="props"> <q-th auto-width style="text-align: center" v-for="col in props.cols" :key="col.name" :props="props" class="text-h4 text-indigo-10" > {{ col.label }} </q-th> <q-th auto-width>Acción</q-th> </q-tr> </template> <template v-slot:body="props"> <q-tr :props="props"> <q-td style="text-align: center" v-for="col in props.cols" :key="col.name" :props="props" > <!--{{ col.value | upper }}--> {{ col.value }} </q-td> <q-td auto-width style="text-align: center"> <template> <div class="q-gutter-sm"> <q-btn color="primary" round dense icon="edit" @click="editarDocente(props.row)" ></q-btn> <q-dialog v-model="formActualizar" persistent transition-show="scale" transition-hide="scale" > <q-card style="width: 300px"> <q-card-section> <div class="text-h6">Docente</div> </q-card-section> <q-card-section style="max-height: 50vh" class="scroll" > <q-form class="q-gutter-md"> <q-input v-model.trim="nombress" label="Nombres" lazy-rules :rules="[ (val) => (val && val.length > 0) || '* Requerido', ]" ></q-input> <q-input v-model.trim="apellidoss" label="Apellidos" lazy-rules :rules="[ (val) => (val && val.length > 0) || '* Requerido', ]" ></q-input> <q-select disable v-model=" id_ctlg_tipos_documentoss " :options=" options.tipos_documentos " label="Tipo de documento" emit-value map-options ></q-select> <q-input v-model="numero_documentoss" label="Número de documento" type="number" ></q-input> <q-select v-model=" id_ctlg_profesioness " :options=" options.profesiones " label="Profesión" emit-value map-options ></q-select> <q-input v-model.trim="correoss" label="Correo" type="email" ></q-input> <q-input v-model="direccionss" label="Dirección" lazy-rules :rules="[ (val) => (val && val.length > 0) || '* Requerido', ]" ></q-input> <q-input v-model="telefonoss" label="Celular" type="tel" mask=" ##-########" ></q-input> </q-form> </q-card-section> <q-card-actions align="right"> <q-btn color="primary" @click="guardar" >Guardar</q-btn > <q-btn flat v-close-popup >cancelar</q-btn > </q-card-actions> </q-card> </q-dialog> <q-btn color="negative" round dense icon="delete" @click="eliminar(props.row)" ></q-btn> </div> </template> </q-td> </q-tr> </template> </q-table> <template v-slot:loading> <q-inner-loading showing color="primary"></q-inner-loading> </template> </q-page></template>