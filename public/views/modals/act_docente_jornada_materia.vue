<script>module.exports={data:function data(){return{step:1,id_estudiantes:null,form:{_nombres:"",_apellidos:"",_id_ctlg_tipos_documentos:"",_numero_documento:"",_correo:"",_direccion:"",_telefono:"",_celular:"",_id_ctlg_profesiones:"",_id_ctlg_estados_civil:"",_id_ctlg_cantones:"",_id_ctlg_parentescos:"",_lugar_trabajo:"",_direccion_trabajo:"",_telefono_trabajo:"",_cargo:""},options:{tipos_documentos:[],profesiones:[],estados_civil:[],estudiantes:[],cantones:[],parentescos:[]}}},created:function created(){var a=this;_.merge(this.form,_.get(this,"formOld",{})),Promise.all([this.tipos_documentos(),this.profesiones(),this.estados_civil(),this.estudiantes(),this.cantones(),this.parentescos()]).then(function(){a.init()})},methods:{profesiones:function profesiones(){var a=this;return _.rget("catalogos/profesiones").then(function(b){a.options.profesiones=b.data})},tipos_documentos:function tipos_documentos(){var a=this;return _.rget("catalogos/tipos_documentos").then(function(b){a.options.tipos_documentos=b.data})},estados_civil:function estados_civil(){var a=this;return _.rget("catalogos/estados_civil").then(function(b){a.options.estados_civil=b.data})},estudiantes:function estudiantes(){var a=this;return _.rget("estudiantes/ctlg").then(function(b){a.options.estudiantes=b.data})},cantones:function cantones(){var a=this;return _.rget("catalogos/cantones").then(function(b){a.options.cantones=b.data})},parentescos:function parentescos(){var a=this;return _.rget("catalogos/parentescos").then(function(b){a.options.parentescos=b.data})},guardar:function guardar(){var a=this;if(1==this.form._id_ctlg_tipos_documentos){var b=this.form._numero_documento;if(10==b.length){var c=b.substring(0,2);if(1<=c&&24>=c){var d=b.substring(9,10),e=parseInt(b.substring(1,2))+parseInt(b.substring(3,4))+parseInt(b.substring(5,6))+parseInt(b.substring(7,8)),f=b.substring(0,1),f=2*f;if(9<f)var f=f-9;var g=b.substring(2,3),g=2*g;if(9<g)var g=g-9;var h=b.substring(4,5),h=2*h;if(9<h)var h=h-9;var i=b.substring(6,7),i=2*i;if(9<i)var i=i-9;var j=b.substring(8,9),j=2*j;if(9<j)var j=j-9;var k=f+g+h+i+j,l=e+k,m=(l+"").substring(0,1),n=10*(parseInt(m)+1),o=n-l;if(10==o)var o=0;o==d?(this.$q.loading.show(),_.rpost("familiares",null,this.form).then(function(){a.close(),a.$parent.listaFamiliares()})["catch"](function(b){a.$q.notify({type:"negative",message:b.message||"Hubo un error al guardar"})})["finally"](function(){a.$q.loading.hide()})):this.$q.notify({type:"negative",message:"la cedula es incorrecta"})}else this.$q.notify({type:"negative",message:"Esta cedula no pertenece a ninguna region"})}else this.$q.notify({type:"negative",message:"Esta cedula tiene menos de 10 Digitos"})}else this.$q.loading.show(),_.rpost("familiares",null,this.form).then(function(){a.$parent.listaFamiliares()})["catch"](function(b){a.$q.notify({type:"negative",message:b.message||"Hubo un error al guardar"})})["finally"](function(){a.$q.loading.hide()})},terminar:function terminar(){var a=this;this.$q.loading.show(),_.rpost("familiares/crearr",null,{_id_estudiantes:this.id_estudiantes}).then(function(){a.close(),a.$parent.listaFamiliares()})["catch"](function(b){a.$q.notify({type:"negative",message:b.message||"Hubo un error al guardar"})})["finally"](function(){a.$q.loading.hide()})}}};</script> <style></style> <template><q-dialog v-model="state" persistent transition-show="scale" transition-hide="scale"> <q-card style="width: 380px"> <div class="q-pa-md">    <q-stepper      v-model="step"      ref="stepper"      animated      active-color="primary"    >       <q-step        :name="1"        prefix="1"        title="Representante" :done="step > 1"        :header-nav="step > 1"      >   <q-card-section style="max-height: 50vh" >           <q-form class="q-gutter-md" > <q-input v-model="form._nombres" label="Nombres" lazy-rules :rules="[ val => val && val.length > 0 || 'Please type something']" ></q-input> <q-input v-model="form._apellidos" label="Apellidos" lazy-rules :rules="[ val => val && val.length > 0 || 'Please type something']" ></q-input> <q-select v-model="form._id_ctlg_tipos_documentos"  :options="options.tipos_documentos" label="Tipo de documento" emit-value map-options></q-select> <q-input v-model="form._numero_documento" label="Número de documento" type=number ></q-input> <q-select v-model="form._id_ctlg_profesiones"  :options="options.profesiones" label="Profesión" emit-value map-options></q-select> <q-select v-model="form._id_ctlg_parentescos"  :options="options.parentescos" label="Parentesco" emit-value map-options></q-select> <q-input v-model="form._correo" label="Correo" lazy-rules :rules="[ val => val && val.length > 0 || 'Please type something']" ></q-input> <q-input v-model="form._direccion" label="Dirección" lazy-rules :rules="[ val => val && val.length > 0 || 'Please type something']" ></q-input> <q-input v-model="form._telefono" label="Telefono" mask=" ### - ####" ></q-input> <q-input v-model="form._celular" label="Celular" ></q-input> <q-select v-model="form._id_ctlg_estados_civil"  :options="options.estados_civil" label="Estados Civil" emit-value map-options></q-select> <q-input v-model="form._lugar_trabajo" label="Empresa que labora" lazy-rules :rules="[ val => val && val.length > 0 || 'Please type something']" ></q-input> <q-input v-model="form._direccion_trabajo" label="Direccion Trabajo" lazy-rules :rules="[ val => val && val.length > 0 || 'Please type something']" ></q-input> <q-select v-model="form._id_ctlg_cantones"   :options="options.cantones" label="Cantón de Trabajo" emit-value map-options></q-select> <q-input v-model="form._telefono_trabajo" label="Telefono Trabajo" mask=" ### - ####"          ></q-input> <q-input v-model="form._cargo" label="Cargo que ocupa" lazy-rules :rules="[ val => val && val.length > 0 || 'Please type something']" ></q-input> </q-form> <q-card-actions align="right"> <q-stepper-navigation> <q-btn @click="guardar(); $refs.stepper.next()" color="primary" label="Guardar" ></q-btn> <q-btn flat v-close-popup >cancelar</q-btn> </q-stepper-navigation> </q-card-actions> </q-card-section>         </q-step>      <q-step        :name="2"        prefix="2"        title="Estudiante" :header-nav="step > 2"             >         <q-card-section style="max-height: 50vh" >        <q-form class="q-gutter-md" >                <q-select  v-model="id_estudiantes"   :options="options.estudiantes"  label="Estudiante"  use-input use-input multiple map-options emit-value option-value="value" option-label="label" use-chips stack-label input-debounce="0" ></q-select> </q-form><q-card-actions align="right"> <q-stepper-navigation>  <q-btn color="primary" @click="terminar" label="Terminar" ></q-btn>  <q-btn flat v-close-popup >cancelar</q-btn> </q-stepper-navigation> </q-card-actions></q-card-section>  <q-stepper-navigation>                          </q-stepper-navigation>            </q-step>     <!-- <template v-slot:navigation>        <q-stepper-navigation>          <q-btn @click="$refs.stepper.next()" color="deep-orange" :label="step === 2 ? '<q-btn color="primary" @click="guardar">Guardar</q-btn>' : 'Continuar'" />          <q-btn v-if="step > 1" flat color="deep-orange" @click="$refs.stepper.previous()" label="Back" class="q-ml-sm" />           </q-stepper-navigation>      </template> -->      </q-stepper>  </div> </q-card>   </q-dialog> </template>